:root{
  --border:#e6e6e6; --text:#111; --muted:#666; --bg:#fff; --topbar:56px; --sidebar:300px;
}
/* 顶栏 */
.topbar{
  position:sticky;top:0;z-index:1000;display:flex;align-items:center;gap:12px;
  height:var(--topbar);background:var(--bg);border-bottom:1px solid var(--border);padding:0 12px;
}
.brand{font-weight:700;color:var(--text)}
.spacer{flex:1}
.user-info{display:flex;align-items:center;gap:8px;}
.logout-btn{height:30px;padding:0 12px;border:1px solid var(--border);border-radius:6px;background:#fff;color:var(--text);cursor:pointer;font-size:12px;}
.logout-btn:hover{background:#f8f8f8;}
.api-badge{display:inline-flex;align-items:center;gap:6px;font-size:12px;color:#666;padding:2px 8px;border:1px solid var(--border);border-radius:999px}
.api-dot{width:8px;height:8px;border-radius:50%;}
.api-dot.ok{background:#22c55e}
.api-dot.err{background:#ef4444}
.api-dot.wait{background:#f59e0b}

/* 主容器与卡片 */
/* 使用自定义 --vh，避免 iOS 100vh 被地址栏压缩；并允许内容溢出时自然增高 */
.app{min-height:calc(var(--vh, 1vh)*100 - var(--topbar));height:auto;display:flex}
.card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:24px}

/* 侧边栏样式 */
.wrap{display:flex;width:100%;height:100%;}
aside{
  width:var(--sidebar);background:var(--bg);border-right:1px solid var(--border);
  display:flex;flex-direction:column;overflow-y:auto;padding:20px 0;
}
.sidebar-section{padding:0 20px 24px 20px;}
.sidebar-section h3{margin:0 0 16px 0;font-size:16px;font-weight:600;color:var(--text);}

/* 统计网格 */
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.stat-item{text-align:center;padding:12px;background:#f8f9fa;border-radius:8px;}
.stat-number{font-size:18px;font-weight:700;color:var(--text);margin-bottom:4px;}
.stat-label{font-size:12px;color:var(--muted);}

/* 导航 */
nav{padding:0;}
nav a{
  display:flex;align-items:center;gap:12px;padding:12px 20px;color:var(--text);
  text-decoration:none;border-bottom:1px solid var(--border);transition:all 0.2s;
}
nav a:hover{background:#f8f9fa;}
nav a.active{background:#333;color:#fff;}

/* 主内容区 */
main{flex:1;overflow-y:auto;padding:20px;}

/* 表单/按钮 */
.btn{
  height:40px;padding:0 16px;border-radius:8px;border:1px solid var(--border);
  background:#fff;cursor:pointer;font-size:14px;font-weight:500;transition:all 0.2s;
  display:inline-flex;align-items:center;justify-content:center;text-decoration:none;
}
.btn:active{transform:translateY(1px)}
.btn:hover{background:#f8f8f8}
.btn-solid{border-color:#333;background:#333;color:#fff}
.btn-solid:hover{background:#555;border-color:#555}
.btn-outline{border-color:#333;background:#fff;color:#333}
.btn-outline:hover{background:#f5f5f5}
.btn-primary{border-color:#e6b56c;background:#fab041;color:#fff}
.btn-primary:hover{background:#fab041;border-color:#fab041}

/* 日历样式 */
.calendar-head{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:20px}
.calendar-title{font-weight:700;font-size:20px;color:var(--text)}
.calendar-ctrl{margin-left:auto;display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
.seg{display:flex;border:1px solid var(--border);border-radius:8px;overflow:hidden}
.seg-btn{
  border:0;background:#fff;padding:8px 16px;cursor:pointer;border-right:1px solid var(--border);
  font-size:14px;color:var(--text);transition:all 0.2s;
}
.seg-btn:last-child{border-right:0}
.seg-btn:hover{background:#f8f8f8}
.seg-btn.active{background:#333;color:#fff}

#mainCalendar{margin-top:20px;}

/* FullCalendar 自定义 */
.fc{font-size:14px;}
.fc-toolbar{margin-bottom:16px;}
.fc-button{
  background:#fff;border:1px solid var(--border);color:var(--text);
  border-radius:6px;padding:6px 12px;transition:all 0.2s;
}
.fc-button:hover{background:#f8f8f8;}
.fc-button-active{background:#333 !important;color:#fff !important;}

/* 页面内容 */
.page-content{display:none;}
.page-content.active{display:block;}

/* 登录样式（沿用你原来的简洁布局） */
.login-container{display:flex;align-items:center;justify-content:center;height:100vh;background:#fafafa;}
.login-box{width:320px;background:#fff;border:1px solid var(--border);border-radius:12px;padding:24px;box-shadow:0 4px 16px rgba(0,0,0,0.04);}
.login-box h1{font-size:20px;margin:0 0 12px 0}
.login-box input, .login-box select{width:100%;height:40px;border:1px solid var(--border);border-radius:8px;padding:0 12px;margin-top:8px;}
.login-box button{width:100%;height:40px;margin-top:12px;}
.link-text{margin-top:8px;color:#555;cursor:pointer;font-size:12px;text-align:center;}
.error-message{margin-top:8px;color:#c00;font-size:12px;}
.api-inline{margin-top:8px;font-size:12px;color:#666}

/* 表单样式（分析页等） */
.filter-item{margin-bottom:16px;}
.filter-item label{display:block;margin-bottom:6px;color:var(--muted);font-weight:500;font-size:14px;}
.filter-item input, .filter-item select{
  width:100%;height:40px;border:1px solid var(--border);border-radius:8px;padding:0 12px;
  background:#fff;color:var(--text);font-size:14px;
}
.filter-item input:focus, .filter-item select:focus{outline:none;border-color:#999;}

/* 数据分析页面样式 */
.filter-panel{margin-bottom:24px;}
.filter-section{margin-bottom:20px;padding:16px;background:#f8f9fa;border-radius:8px;}
.filter-section h3{margin:0 0 12px 0;font-size:16px;font-weight:600;color:var(--text);}
.filter-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.student-list{max-height:150px;overflow-y:auto;border:1px solid var(--border);border-radius:4px;padding:8px;}
.action-buttons{display:flex;gap:12px;margin-top:16px;}
.results-panel{margin-top:24px;padding:16px;border:1px solid var(--border);border-radius:8px;}
.results-header{font-size:16px;font-weight:600;margin-bottom:12px;color:var(--text);}
.data-table{width:100%;border-collapse:collapse;margin-top:12px;}
.data-table th, .data-table td{padding:8px;text-align:left;border-bottom:1px solid var(--border);font-size:14px;}
.data-table th{background:#f8f9fa;font-weight:600;}
.loading{display:flex;align-items:center;gap:8px;color:var(--muted);}
.spinner{width:16px;height:16px;border:2px solid var(--border);border-top:2px solid var(--text);border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}

/* 响应式 */
@media (max-width: 768px) {
  .wrap{flex-direction:column;}
  aside{width:100%;height:auto;border-right:none;border-bottom:1px solid var(--border);}
  main{padding:12px;}
  .calendar-ctrl{margin-left:0;width:100%;justify-content:space-between;}
  .seg{flex:1;}
  .seg-btn{flex:1;font-size:12px;padding:6px 8px;}
}
/* 让整个页面而不是内部容器滚动，修复“不能下拉”的问题 */
html, body{height:auto;min-height:100%;overflow-y:auto}

/* 手机端：隐藏“今日概览”，并让内部容器不再强制内部滚动 */
@media (max-width: 768px){
  .sidebar-section.overview{display:none;}  /* 今日概览隐藏 */
  .wrap{height:auto;}                       /* 外层容器不锁高 */
  main{overflow:visible;}                   /* 让 body 承担滚动 */
}
/* ===== 手机端：把侧栏（今日概览+导航）变成抽屉 ===== */
@media (max-width:768px){
  aside{ display:none; }                           /* 默认隐藏 */
  body.mobile-menu-open aside{                     /* 点击横条后显示 */
    display:block;
    margin-bottom:8px;
  }
  .wrap{ height:auto; }                            /* 交给 body 滚动，避免“卡住” */
  main{ overflow:visible; }
}

/* 抽屉开关：与卡片同宽的窄横条 */
.pull-strip{
  display:flex; align-items:center; justify-content:center; gap:10px;
  height:26px; margin:6px 0 8px 0;
  border:1px solid var(--border); border-radius:10px;
  background:#f7f8fa; color:#666; cursor:pointer;
  user-select:none; -webkit-user-select:none; touch-action:manipulation;
}
.pull-strip .grip{ width:44px; height:4px; border-radius:99px; background:#d1d5db; }
.pull-strip .label{ font-size:12px; }
.pull-strip:hover{ background:#f2f4f6; }

/* ===== 登录输入框“外凸”修正 + iOS 输入不再放大 ===== */
.login-container .login-box input,
.login-container .login-box button{
  width:100%; box-sizing:border-box; display:block; /* 关键：不再鼓出卡片边界 */
}
@media (max-width:768px){
  input, select, textarea, button{ font-size:16px; } /* 关键：>=16px iOS 不会自动放大 */
}
html, body{ overflow-x:hidden; }

/* ===== 手机端顶栏：API 绿点在“欢迎”前；第二行右对齐 ===== */
@media (max-width:768px){
  .topbar{ flex-wrap:wrap; gap:8px; height:auto; padding:8px 12px; }
  .brand{ order:1; font-size:18px; }   /* 第一行左侧 */
  .spacer{ display:none; }
  .api-badge{ order:2; border:none; padding:0 4px; } /* 绿点 */
  #apiTextTop{ display:none; }          /* 只保留绿点，不显示文字 */
  .api-dot{ width:10px; height:10px; }
  .user-info{ order:3; width:100%; justify-content:flex-end; } /* 第二行右侧：欢迎… 退出 */
}
